'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

Object.defineProperty(exports, '__esModule', {
    value: true
});

var _this = this;

var _fsJetpack = require('fs-jetpack');

exports['default'] = function callee$0$0(searchPath) {
    var appPaths, appDirs;
    return _regeneratorRuntime.async(function callee$0$0$(context$1$0) {
        while (1) switch (context$1$0.prev = context$1$0.next) {
            case 0:
                context$1$0.next = 2;
                return _regeneratorRuntime.awrap((0, _fsJetpack.findAsync)(searchPath, { matching: ['*.app'] }));

            case 2:
                appPaths = context$1$0.sent;
                appDirs = appPaths.filter(function (path) {
                    return (0, _fsJetpack.exists)(path) === 'dir';
                });

                if (appDirs.length) {
                    context$1$0.next = 6;
                    break;
                }

                throw new Error('Unable to detect .app folder');

            case 6:
                if (!(appDirs.length > 1)) {
                    context$1$0.next = 8;
                    break;
                }

                throw new Error('Multiple .app folders found');

            case 8:
                return context$1$0.abrupt('return', appDirs.pop());

            case 9:
            case 'end':
                return context$1$0.stop();
        }
    }, null, _this);
};

module.exports = exports['default'];